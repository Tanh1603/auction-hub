# 3.9.5 Clear Cache

## 1. Use Case Description

| Field              | Description                                                                                                     |
| ------------------ | --------------------------------------------------------------------------------------------------------------- |
| **Name**           | Clear Cache                                                                                                     |
| **Description**    | This use case allows the Admin to manually clear the system variables cache for troubleshooting or updates.     |
| **Actor**          | Admin, Super Admin                                                                                              |
| **Trigger**        | When the Admin requests `POST /system-variables/cache/clear`.                                                   |
| **Pre-condition**  | • Admin's device must be connected to the internet.<br>• Admin is signed in with `admin` or `super_admin` role. |
| **Post-condition** | The system variables cache is cleared, forcing fresh database reads on next access.                             |

## 2. Sequence Flow (MVC)

```plantuml
@startuml
autonumber
skinparam sequenceMessageAlign center

actor "Admin" as User
boundary "SystemConfigPage" as View
control "SystemVariablesController" as Controller
control "SystemVariablesService" as Service

User -> View: Request Cache Clear
View -> Controller: POST /system-variables/cache/clear?category=xxx
activate Controller

Controller -> Service: clearCache(category?)
activate Service

alt Category Specified
    Service -> Service: clearCategoryCache(category)
    note right: BR-02
else No Category
    Service -> Service: clearAllCache()
    note right: BR-03
end

Service --> Controller: SuccessResponse
Controller --> View: 200 OK (Cache Cleared)
View --> User: Show Success Message

deactivate Service
deactivate Controller
@enduml
```

## 3. Activities Flow (Swimlanes)

```plantuml
@startuml
|Admin|
start
:(1) Navigate to Cache Management;
:(2) Select Clear Option;

|SystemVariablesController|
:(3) Authenticate & Authorize;
note right: BR-01

|SystemVariablesService|
if (Category Specified?) then (Yes)
    :(4.1) Clear Category Cache;
    note right: BR-02
else (No)
    :(4.2) Clear All Cache;
    note right: BR-03
endif

:(5) Return Success Response;

|Admin|
:(6) View Confirmation Message;
stop
@enduml
```

## 4. Business Rules

| Activity  | BR Code   | Description                                                                                                                                                                                           |
| :-------- | :-------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **(1)**   | **BR-01** | **Displaying Rule (Cache Management):**<br>System displays cache management section with:<br>- "Clear All Cache" button<br>- Category-specific clear options<br>- Cache statistics display.           |
| **(3)**   | **BR-02** | **Validation Rule (Authorization - Back-end):**<br>System checks if requestor role is `admin` or `super_admin`.<br>If unauthorized:<br>$\rightarrow$ System displays MSG 5 ("Forbidden") on the View. |
| **(4.1)** | **BR-03** | **Processing Rule (Category Clear):**<br>System clears cache entries for specified category only.<br>Other categories remain cached.<br>Useful for targeted cache refresh.                            |
| **(4.2)** | **BR-04** | **Processing Rule (Full Clear):**<br>System clears entire system variables cache.<br>All subsequent reads will hit database.<br>Performance impact: temporary until cache repopulates.                |
| **(6)**   | **BR-05** | **Displaying Rule (Success Confirmation):**<br>System displays MSG "Cache cleared successfully" on the View.<br>If category specified: "Cache cleared for category: [category]".                      |
