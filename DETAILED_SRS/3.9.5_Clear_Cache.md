# 3.9.5 Clear Cache

## 1. Use Case Description

| Field              | Description                                                                                                     |
| ------------------ | --------------------------------------------------------------------------------------------------------------- |
| **Name**           | Clear Cache                                                                                                     |
| **Description**    | This use case allows the Admin to manually clear the system variables cache for troubleshooting or updates.     |
| **Actor**          | Admin, Super Admin                                                                                              |
| **Trigger**        | When the Admin requests `POST /system-variables/cache/clear`.                                                   |
| **Pre-condition**  | • Admin's device must be connected to the internet.<br>• Admin is signed in with `admin` or `super_admin` role. |
| **Post-condition** | The system variables cache is cleared, forcing fresh database reads on next access.                             |

## 2. Sequence Flow (MVC)

```plantuml
@startuml
autonumber
skinparam sequenceMessageAlign center

actor "Admin" as User
boundary "SystemConfigPage" as View
control "SystemVariablesController" as Controller
control "SystemVariablesService" as Service

User -> View: Request Cache Clear
View -> Controller: POST /system-variables/cache/clear?category=xxx
activate Controller

Controller -> Service: clearCache(category?)
activate Service

alt Category Specified
    Service -> Service: clearCategoryCache(category)
    note right: BR-02
else No Category
    Service -> Service: clearAllCache()
    note right: BR-03
end

Service --> Controller: SuccessResponse
Controller --> View: 200 OK (Cache Cleared)
View --> User: Show Success Message

deactivate Service
deactivate Controller
@enduml
```

## 3. Activities Flow (Swimlanes)

```plantuml
@startuml
|Admin|
start
:(1) Navigate to Cache Management;
:(2) Select Clear Option;

|SystemVariablesController|
:(3) Authenticate & Authorize;
note right: BR-01

|SystemVariablesService|
if (Category Specified?) then (Yes)
    :(4.1) Clear Category Cache;
    note right: BR-02
else (No)
    :(4.2) Clear All Cache;
    note right: BR-03
endif

:(5) Return Success Response;

|Admin|
:(6) View Confirmation Message;
stop
@enduml
```

## 4. Business Rules

| Activity  | BR Code   | Description                                                                                                                                                                                           |
| :-------- | :-------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **(1)**   | **BR-01** | **Displaying Rule:**<br><br>Function: `Display_View('SystemConfigPage')`<br><br>Logic:<br>Render [Clear All Cache] button.<br>Render category-specific [Clear Cache] buttons.                           |
| **(3)**   | **BR-02** | **Authorization Rule (Back-end):**<br><br>Function: Call `SystemVariablesService.clearCache()`<br><br>Logic:<br>Check Requestor Role.<br>IF Role NOT IN ['admin', 'super_admin'] THEN Return 403 (Forbidden). |
| **(4.1)** | **BR-03** | **Processing Rule (Back-end):**<br><br>Function: `CacheService.clearCategoryCache(category)`<br><br>Logic:<br>Remove entries related to [category] from cache.                                          |
| **(4.2)** | **BR-04** | **Processing Rule (Back-end):**<br><br>Function: `CacheService.clearAllCache()`<br><br>Logic:<br>Remove ALL system variable entries from cache.                                                         |
| **(6)**   | **BR-05** | **Displaying Rule (Success):**<br><br>Function: `Display_Notification('Success', message)`<br><br>Logic:<br>Show Toast: "Cache cleared successfully."<br>IF category THEN "Cache cleared for [category]". |