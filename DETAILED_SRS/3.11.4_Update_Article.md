# 3.11.4 Update Article

## 1. Use Case Description

| Field              | Description                                                                                                             |
| ------------------ | ----------------------------------------------------------------------------------------------------------------------- |
| **Name**           | Update Article                                                                                                          |
| **Description**    | This use case allows the Admin to update an existing article's content and metadata.                                    |
| **Actor**          | Admin, Super Admin                                                                                                      |
| **Trigger**        | When the Admin submits updates via `PUT /articles/:id`.                                                                 |
| **Pre-condition**  | • Admin's device must be connected to the internet.<br>• Admin is signed in with admin privileges.<br>• Article exists. |
| **Post-condition** | The article is updated in the database.                                                                                 |

## 2. Sequence Flow (MVC)

```plantuml
@startuml
autonumber
skinparam sequenceMessageAlign center

actor "Admin" as User
boundary "EditArticlePage" as View
control "ArticleController" as Controller
control "ArticleService" as Service
entity "ArticleRepository" as Repo

User -> View: Edit Article Form
View -> Controller: PUT /articles/:id\n{ updateArticleDto }
activate Controller

Controller -> Service: update(id, updateArticleDto)
activate Service

Service -> Repo: findById(id)
activate Repo
Repo --> Service: ArticleEntity
deactivate Repo

alt Article Found
    Service -> Repo: update(id, { ...dto })
    activate Repo
    Repo --> Service: UpdatedArticle
    deactivate Repo

    Service --> Controller: ArticleDto
    Controller --> View: 200 OK (Updated)
    View --> User: Show Success Message
else Article Not Found
    Service --> Controller: Throw NotFoundException
    Controller --> View: 404 Not Found
    View --> User: Display Error Message
end

deactivate Service
deactivate Controller
@enduml
```

## 3. Activities Flow (Swimlanes)

```plantuml
@startuml
|Admin|
start
:(1) Select Article to Edit;
:(2) Modify Article Details;
:(3) Submit Updates;

|ArticleController|
:(4) Authenticate & Authorize;
note right: BR-01

|ArticleService|
:(5) Validate Input Data;
note right: BR-02

|ArticleRepository|
:(6) Verify Article Exists;

if (Article Found?) then (No)
    |ArticleService|
    :(7.1) Return 404 Not Found;
    |Admin|
    :(7.2) View Error Message;
    stop
endif

|ArticleRepository|
:(8) Update Article Record;

|ArticleService|
:(9) Return Success Response;

|Admin|
:(10) View Updated Article;
stop
@enduml
```

## 4. Business Rules

| Activity | BR Code   | Description                                                                                                                                                                                           |
| :------- | :-------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **(1)**  | **BR-01** | **Displaying Rule (Edit Article Page):**<br>System pre-fills form with existing article data.<br>All fields are editable: type, title, description, content, author, image.                           |
| **(4)**  | **BR-02** | **Validation Rule (Authorization - Back-end):**<br>System checks if requestor role is `admin` or `super_admin`.<br>If unauthorized:<br>$\rightarrow$ System displays MSG 5 ("Forbidden") on the View. |
| **(5)**  | **BR-03** | **Validation Rule (Input):**<br>Same validation rules as create apply.<br>Type must be valid enum value.<br>Title: max 255 chars.                                                                     |
| **(8)**  | **BR-04** | **Storing Rule:**<br>System updates `ARTICLE` table:<br>- All provided fields updated<br>- `updatedAt = now()`<br>- Unprovided fields remain unchanged.                                               |
| **(10)** | **BR-05** | **Displaying Rule (Success Confirmation):**<br>System displays MSG 7 ("Article updated successfully") on the View.<br>System refreshes article display with new content.                              |
