# Use Case 3.5.0: Manage Bidding

## 1. Use Case Description

| Field              | Content                                                                                                                                   |
| :----------------- | :---------------------------------------------------------------------------------------------------------------------------------------- |
| **Name**           | Manage Bidding                                                                                                                            |
| **Description**    | This use case allows the **Bidder** to choose one of the corresponding functions of CRUD to adjust **Bidding** information in the system. |
| **Actor**          | **Bidder**, **Auctioneer**, **Admin**, **System**                                                                                         |
| **Trigger**        | When the **Bidder** clicks on the "**Bidding**" button on the navigation sidebar or joins an active auction room.                         |
| **Pre-condition**  | 1. **Bidder**'s device must be connected to the internet.<br>2. **Bidder** is signed in with their account.                               |
| **Post-condition** | The **Bidding** information is updated to the corresponding function that the **Bidder** executes.                                        |

---

## 2. Sequence Flow

```plantuml
@startuml
autonumber
skinparam sequenceMessageAlign center

actor "Bidder" as User
boundary "BiddingPage" as View
control "ManualBidController" as Controller
control "BiddingGateway" as WebSocket
entity "AuctionBidRepository" as Repo

User -> View: Access Bidding interface
View -> Controller: GET /auctions/:id
activate Controller
Controller -> Repo: findActiveAuctions()
activate Repo
Repo --> Controller: AuctionData
deactivate Repo
Controller --> View: Return auction data
deactivate Controller
View --> User: Display Bidding options

User -> View: Choose function

opt Place Manual Bid
    ref over View, Controller, Repo: Sequence Place Manual Bid (3.5.1)
end

opt Deny Bid
    ref over View, Controller, Repo: Sequence Deny Bid (3.5.2)
end

opt Join Auction Room
    ref over View, WebSocket, Repo: Sequence Join Auction Room (3.5.3)
end

opt Leave Auction Room
    ref over View, WebSocket, Repo: Sequence Leave Auction Room (3.5.4)
end

opt Receive Auction State
    ref over View, WebSocket, Repo: Sequence Receive Auction State (3.5.5)
end

opt Receive New Bid Notification
    ref over View, WebSocket, Repo: Sequence Receive New Bid Notification (3.5.6)
end

opt Receive Time Updates
    ref over View, WebSocket, Repo: Sequence Receive Time Updates (3.5.7)
end

opt Receive Bid Denied Notification
    ref over View, WebSocket, Repo: Sequence Receive Bid Denied Notification (3.5.8)
end

opt Receive Auction Update
    ref over View, WebSocket, Repo: Sequence Receive Auction Update (3.5.9)
end
@enduml
```

---

## 3. Activities Flow (Swimlanes)

```plantuml
@startuml
|Bidder|
start
:(1) Access Bidding Interface;
:(2) View Bidding Options;

|ManualBidController|
:(3) Retrieve Auction Data;
note right: BR-01

|AuctionBidRepository|
:(4) Query Active Auctions;

|Bidder|
:(5) Display Bidding Options;
:(6) Choose Function;

partition "REST API Actions" {
    if (Which Function?) then (Place Bid)
        :(7.1) Go to Place Manual Bid;
        note right: Ref: 3.5.1
        stop
    elseif (Deny Bid) then
        :(7.2) Go to Deny Bid;
        note right: Ref: 3.5.2
        stop
    endif
}

partition "WebSocket Actions" {
    if (Which WS Function?) then (Join Room)
        :(8.1) Go to Join Auction Room;
        note right: Ref: 3.5.3
        stop
    elseif (Leave Room) then
        :(8.2) Go to Leave Auction Room;
        note right: Ref: 3.5.4
        stop
    elseif (Auction State) then
        :(8.3) Receive Auction State;
        note right: Ref: 3.5.5
        stop
    elseif (New Bid) then
        :(8.4) Receive New Bid Notification;
        note right: Ref: 3.5.6
        stop
    elseif (Time Update) then
        :(8.5) Receive Time Updates;
        note right: Ref: 3.5.7
        stop
    elseif (Bid Denied) then
        :(8.6) Receive Bid Denied Notification;
        note right: Ref: 3.5.8
        stop
    else (Auction Update)
        :(8.7) Receive Auction Update;
        note right: Ref: 3.5.9
        stop
    endif
}
@enduml
```

---

## 4. Business Rules

| Activity | BR Code   | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| :------- | :-------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **(5)**  | **BR-01** | **Displaying Rules:**<br>❖ The system renders the “BiddingPage” screen via `Display_View()`. (Refer to “BiddingPage” view in “View Description” file).<br>❖ The screen displays the details of the active Auction.<br>❖ It renders dynamic components: the [Current Bid], the [Next Minimum Bid], and a real-time [Countdown Timer].                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **(6)**  | **BR-02** | **Choosing Rules:**<br>❖ The Bidder selects an action from the bidding interface. The system uses `Frontend_Navigation()` to direct the flow.<br>❖ If “Place Bid” is selected, the system triggers `3.5.1`.<br>❖ If “Deny Bid” is selected (Admin/Auctioneer only), it redirects to `3.5.2`.<br>❖ If “Join Room” is selected (automatic on page load), it triggers `3.5.3`.<br>❖ Only one feature can be selected at a time.                                                                                                                                                                                                                                                                                                                                                                                                                                            |

---

## 5. Related Child Use Cases

### REST API Actions

| Use Case ID | Use Case Name    | Description                             |
| :---------- | :--------------- | :-------------------------------------- |
| 3.5.1       | Place Manual Bid | Submit a manual bid during live auction |
| 3.5.2       | Deny Bid         | Admin/Auctioneer denies a submitted bid |

### WebSocket Real-time Events

| Use Case ID | Use Case Name                   | Description                                   |
| :---------- | :------------------------------ | :-------------------------------------------- |
| 3.5.3       | Join Auction Room               | Connect to auction room for real-time updates |
| 3.5.4       | Leave Auction Room              | Disconnect from auction room                  |
| 3.5.5       | Receive Auction State           | Receive current state of the auction          |
| 3.5.6       | Receive New Bid Notification    | Receive notification when a new bid is placed |
| 3.5.7       | Receive Time Updates            | Receive countdown timer updates               |
| 3.5.8       | Receive Bid Denied Notification | Receive notification when a bid is denied     |
| 3.5.9       | Receive Auction Update          | Receive general auction status updates        |