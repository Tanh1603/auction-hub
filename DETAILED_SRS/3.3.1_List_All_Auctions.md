# 3.3.1 List All Auctions

## 1. Use Case Description

| Field              | Description                                                                                                   |
| ------------------ | ------------------------------------------------------------------------------------------------------------- |
| **Name**           | List All Auctions                                                                                             |
| **Description**    | This use case allows the User to search Auction information in the system based on input keywords.            |
| **Actor**          | User                                                                                                          |
| **Trigger**        | When User enters searching keywords in the SearchBox on the top left of the AuctionListPage screen.           |
| **Pre-condition**  | • User's device must be connected to the internet.<br>• User is on the AuctionListPage.                       |
| **Post-condition** | The datagrid of Auction information will be filtered by keywords and displayed on the AuctionListPage screen. |

## 2. Sequence Flow (MVC)

```plantuml
@startuml
autonumber
skinparam sequenceMessageAlign center

actor "User" as User
boundary "AuctionListPage" as View
control "AuctionController" as Controller
control "AuctionService" as Service
entity "AuctionRepository" as Repo

User -> View: View Auction List (Apply Filters)
View -> Controller: GET /auctions?status=live&page=1&limit=10
activate Controller

Controller -> Service: findAll(query: AuctionQueryDto)
activate Service

Service -> Service: Build Prisma Query\n(Where, OrderBy, Skip, Take)
note right: BR-02, BR-03

Service -> Repo: findMany({ where, ... })
activate Repo
Repo --> Service: AuctionEntity[]
deactivate Repo

Service -> Repo: count({ where })
activate Repo
Repo --> Service: totalCount
deactivate Repo

Service --> Controller: PaginatedResponseDto<Auction>
deactivate Service

Controller --> View: 200 OK (JSON)
deactivate Controller

View --> User: Display Auctions Grid
@enduml
```

## 3. Activities Flow (Swimlanes)

```plantuml
@startuml
|User|
start
:(1) Request Auction List;
:(2) (Optional) Set Filters (Status, Type);

|AuctionService|
:(3) Receive Request;
:(4) Validate Query Parameters;
note right: BR-03

:(5) Construct Database Query;
note right: BR-02

|AuctionRepository|
:(6) Execute Query (findMany);
:(7) Execute Count (for Pagination);

|AuctionService|
:(8) Format Response Data;
note right: BR-04
:(9) Return Response;

|User|
:(10) View Listings;
stop
@enduml
```

## 4. Business Rules

| Activity | BR Code   | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| :------- | :-------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **(1)**  | **BR-01** | **Displaying Rules:**<br>❖ The system displays an “AuctionListPage” screen. (Refer to “AuctionListPage” view in “View Description” file).<br>❖ The screen renders a filter sidebar, allowing users to filter by [Status], [AssetType], and [PriceRange].<br>❖ It also includes a search bar for [Keyword] input and dedicated controls for pagination.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **(2)**  | **BR-02** | **Searching Rules:**<br>❖ When the user enters keywords or applies filters, the system dynamically constructs a Prisma WHERE clause for `AuctionService.findAll(query)`.<br>❖ This clause includes conditions such as: [name] containing the [keyword], [status] being within [selectedStatuses], [assetType] matching [selectedTypes], and [startingPrice] falling between [min] and [max] values.                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **(4)**  | **BR-03** | **Validation Rules (Pagination):**<br>❖ The system validates `page` and `limit` parameters received in the query by calling `Pagination_Logic(page, limit)`.<br>❖ To prevent performance degradation, it enforces a maximum [limit] of 50 records per page.<br>❖ If [page] is less than 1, it defaults to 1. The [skip] value is calculated as `(page - 1) * limit`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **(10)** | **BR-04** | **Displaying Rules (Results):**<br>❖ The system displays the “AuctionListPage” screen with an updated datagrid via `Display_Grid('AuctionGrid', auctions)`.<br>❖ Simplified auction cards are rendered, showing: [Image], [Code], [Name], a [Status] badge, and [StartingPrice].<br>❖ To optimize response times for the list view, heavy fields such as full descriptions and bid histories are excluded.                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
