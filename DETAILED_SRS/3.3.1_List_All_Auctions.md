# 3.3.1 List All Auctions

## 1. Use Case Description

| Field              | Description                                                                                                   |
| ------------------ | ------------------------------------------------------------------------------------------------------------- |
| **Name**           | List All Auctions                                                                                             |
| **Description**    | This use case allows the User to search Auction information in the system based on input keywords.            |
| **Actor**          | User                                                                                                          |
| **Trigger**        | When User enters searching keywords in the SearchBox on the top left of the AuctionListPage screen.           |
| **Pre-condition**  | • User's device must be connected to the internet.<br>• User is on the AuctionListPage.                       |
| **Post-condition** | The datagrid of Auction information will be filtered by keywords and displayed on the AuctionListPage screen. |

## 2. Sequence Flow (MVC)

```plantuml
@startuml
autonumber
skinparam sequenceMessageAlign center

actor "User" as User
boundary "AuctionListPage" as View
control "AuctionController" as Controller
control "AuctionService" as Service
entity "AuctionRepository" as Repo

User -> View: View Auction List (Apply Filters)
View -> Controller: GET /auctions?status=live&page=1&limit=10
activate Controller

Controller -> Service: findAll(query: AuctionQueryDto)
activate Service

Service -> Service: Build Prisma Query\n(Where, OrderBy, Skip, Take)
note right: BR-02, BR-03

Service -> Repo: findMany({ where, ... })
activate Repo
Repo --> Service: AuctionEntity[]
deactivate Repo

Service -> Repo: count({ where })
activate Repo
Repo --> Service: totalCount
deactivate Repo

Service --> Controller: PaginatedResponseDto<Auction>
deactivate Service

Controller --> View: 200 OK (JSON)
deactivate Controller

View --> User: Display Auctions Grid
@enduml
```

## 3. Activities Flow (Swimlanes)

```plantuml
@startuml
|User|
start
:(1) Request Auction List;
:(2) (Optional) Set Filters (Status, Type);

|AuctionService|
:(3) Receive Request;
:(4) Validate Query Parameters;
note right: BR-03

:(5) Construct Database Query;
note right: BR-02

|AuctionRepository|
:(6) Execute Query (findMany);
:(7) Execute Count (for Pagination);

|AuctionService|
:(8) Format Response Data;
note right: BR-04
:(9) Return Response;

|User|
:(10) View Listings;
stop
@enduml
```

## 4. Business Rules

| Activity | BR Code   | Description                                                                                                                                                                                                                                                                                       |
| :------- | :-------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **(1)**  | **BR-01** | **Displaying Rule:**<br>The system displays a 'AuctionListPage' screen. (Refer to 'AuctionListPage' view in 'View Description' file).<br>The screen contains filter options (status, type, price range) and pagination controls.                                                                  |
| **(2)**  | **BR-02** | **Searching Rule:**<br>When user enters keywords or selects filters, system uses `Text_change(Event e)` or `Selection_change()` method.<br>System queries data in the table 'AUCTION' in the database (Refer to 'AUCTION' table in 'DB Sheet' file) based on input keywords and selected filters. |
| **(4)**  | **BR-03** | **Validation Rule (Pagination):**<br>System validates `page` and `limit` parameters.<br>Enforces maximum `limit` (e.g., 50) to prevent performance degradation.<br>If invalid, defaults to standard values (page = 1, limit = 10).                                                                |
| **(10)** | **BR-04** | **Displaying Rule (Results):**<br>The system displays 'AuctionListPage' screen with data on the datagrid updated according to entered filters/keywords.<br>Heavy fields (full descriptions, bid histories) are excluded to optimize list view response.                                           |
