# 3.11.3 Create Article

## 1. Use Case Description

| Field              | Description                                                                                               |
| ------------------ | --------------------------------------------------------------------------------------------------------- |
| **Name**           | Create Article                                                                                            |
| **Description**    | This use case allows the Admin to create a new article (news, auction notice, report, or legal document). |
| **Actor**          | Admin, Super Admin                                                                                        |
| **Trigger**        | When the Admin clicks "Create Article" and submits `POST /articles`.                                      |
| **Pre-condition**  | • Admin's device must be connected to the internet.<br>• Admin is signed in with admin privileges.        |
| **Post-condition** | The new article is created and stored in the database.                                                    |

## 2. Sequence Flow (MVC)

```plantuml
@startuml
autonumber
skinparam sequenceMessageAlign center

actor "Admin" as User
boundary "CreateArticlePage" as View
control "ArticleController" as Controller
control "ArticleService" as Service
entity "ArticleRepository" as Repo

User -> View: Fill Article Form
View -> Controller: POST /articles\n{ type, title, description, content, author, image }
activate Controller

Controller -> Service: create(createArticleDto)
activate Service

Service -> Service: Validate Input
note right: BR-02

Service -> Repo: create({ ...dto })
activate Repo
Repo --> Service: NewArticle
deactivate Repo

Service --> Controller: ArticleDto
Controller --> View: 201 Created
View --> User: Show Success Message

deactivate Service
deactivate Controller
@enduml
```

## 3. Activities Flow (Swimlanes)

```plantuml
@startuml
|Admin|
start
:(1) Navigate to Create Article;
:(2) Fill Article Details;
:(3) (Type, Title, Content, Author);
:(4) Submit Article;

|ArticleController|
:(5) Authenticate & Authorize;
note right: BR-01

|ArticleService|
:(6) Validate Input Data;
note right: BR-02

if (Valid Input?) then (No)
    :(7.1) Return 400 Bad Request;
    |Admin|
    :(7.2) View Error Message;
    stop
endif

|ArticleRepository|
:(8) Insert New Article Record;

|ArticleService|
:(9) Return Success Response;

|Admin|
:(10) View Created Article;
stop
@enduml
```

## 4. Business Rules

| Activity | BR Code   | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| :------- | :-------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **(1)**  | **BR-01** | **Displaying Rules (Create Article Form):**<br>❖ The system renders a “CreateArticlePage” via `Display_View()` to allow for new article creation.<br>❖ The form includes fields for [Type] (dropdown), [Title] (text input), [Description] (textarea), [Content] (rich editor), and [Image] (upload functionality).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **(2)**  | **BR-02** | **Validation Rules (Front-end):**<br>❖ When the Admin submits the form, the system validates the input data using `ValidateInput(CreateArticleDto)`.<br>❖ If the input is not valid:<br>⮚ If [Title], [Content], or [Type] is empty, the system displays **MSG 1** (Mandatory Field).<br>⮚ If the [Title] exceeds 255 characters, the system displays **MSG 4** (Too Long).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **(4)**  | **BR-03** | **Authorization Rules (Back-end):**<br>❖ The system checks the authenticated user's role via `ArticleService.create()` to ensure they have the necessary permissions.<br>❖ If the input is not valid:<br>⮚ If the user's role is not 'admin' or 'super_admin', the system returns a 403 Forbidden status.<br>⮚ The system displays **MSG 5** (Forbidden) on the View.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **(8)**  | **BR-04** | **Storing Rules (Back-end):**<br>❖ The system calls `ArticleRepository.create()` to insert the new article.<br>❖ It saves the [type], [title], [description], [content], and [author] fields.<br>❖ The [image] is stored as JSON containing its URL and public ID after being uploaded.<br>❖ The `createdAt` timestamp is set to the current time.<br>❖ System moves to step (10) and displays successful notification (Refer to **MSG 7**).                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **(10)** | **BR-05** | **Displaying Rules (Success Confirmation):**<br>❖ The system redirects the admin to the Article List Page by calling `Redirect('ArticleListPage')`.<br>❖ A success toast notification confirms that the article has been created.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
