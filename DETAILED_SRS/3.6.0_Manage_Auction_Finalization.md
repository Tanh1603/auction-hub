# Use Case 3.6.0: Manage Auction Finalization

## 1. Use Case Description

| Field              | Content                                                                                                                                               |
| :----------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Name**           | Manage Auction Finalization                                                                                                                           |
| **Description**    | This use case allows the **Admin** to choose one of the corresponding functions of CRUD to adjust **Auction Finalization** information in the system. |
| **Actor**          | **Admin**, **Auctioneer**, **Bidder (Winner)**, **System**                                                                                            |
| **Trigger**        | When the **Admin** clicks on the "**Auction Finalization**" button on the navigation sidebar.                                                         |
| **Pre-condition**  | 1. **Admin**'s device must be connected to the internet.<br>2. **Admin** is signed in with their account.                                             |
| **Post-condition** | The **Auction Finalization** information is updated to the corresponding function that the **Admin** executes.                                        |

---

## 2. Sequence Flow

```plantuml
@startuml
autonumber
skinparam sequenceMessageAlign center

actor "Admin/Winner" as User
boundary "FinalizationPage" as View
control "AuctionFinalizationController" as Controller
entity "AuctionRepository" as Repo

User -> View: Access Finalization Management
View -> Controller: GET /auction-finalization
activate Controller
Controller -> Repo: findPendingFinalization()
activate Repo
Repo --> Controller: AuctionList
deactivate Repo
Controller --> View: Return list data
deactivate Controller
View --> User: Display list of Auctions

User -> View: Choose function

opt Evaluate Auction
    ref over View, Controller, Repo: Sequence Evaluate Auction (3.6.1)
end

opt Finalize Auction
    ref over View, Controller, Repo: Sequence Finalize Auction (3.6.2)
end

opt Override Auction Status
    ref over View, Controller, Repo: Sequence Override Auction Status (3.6.3)
end

opt Get Auction Results
    ref over View, Controller, Repo: Sequence Get Auction Results (3.6.4)
end

opt Get Audit Logs
    ref over View, Controller, Repo: Sequence Get Audit Logs (3.6.5)
end

opt Get Winner Payment Requirements
    ref over View, Controller, Repo: Sequence Get Winner Payment Requirements (3.6.6)
end

opt Initiate Winner Payment
    ref over View, Controller, Repo: Sequence Initiate Winner Payment (3.6.7)
end

opt Verify Winner Payment
    ref over View, Controller, Repo: Sequence Verify Winner Payment (3.6.8)
end
@enduml
```

---

## 3. Activities Flow (Swimlanes)

```plantuml
@startuml
|Admin/Winner|
start
:(1) Access Finalization Management;
:(2) View Auction List;

|AuctionFinalizationController|
:(3) Retrieve Pending Auctions;
note right: BR-01

|AuctionRepository|
:(4) Query Pending Finalization;

|Admin/Winner|
:(5) Display Auction List;
:(6) Choose Function;

if (Which Function?) then (Evaluate)
    :(7.1) Go to Evaluate Auction;
    note right: Ref: 3.6.1
    stop
elseif (Finalize) then
    :(7.2) Go to Finalize Auction;
    note right: Ref: 3.6.2
    stop
elseif (Override Status) then
    :(7.3) Go to Override Auction Status;
    note right: Ref: 3.6.3
    stop
elseif (Get Results) then
    :(7.4) Go to Get Auction Results;
    note right: Ref: 3.6.4
    stop
elseif (Audit Logs) then
    :(7.5) Go to Get Audit Logs;
    note right: Ref: 3.6.5
    stop
elseif (Payment Req) then
    :(7.6) Go to Get Winner Payment Requirements;
    note right: Ref: 3.6.6
    stop
elseif (Initiate Payment) then
    :(7.7) Go to Initiate Winner Payment;
    note right: Ref: 3.6.7
    stop
else (Verify Payment)
    :(7.8) Go to Verify Winner Payment;
    note right: Ref: 3.6.8
    stop
endif
@enduml
```

---

## 4. Business Rules

| Activity | BR Code   | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| :------- | :-------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **(5)**  | **BR-01** | **Displaying Rules:**<br>❖ The system displays a “FinalizationPage” screen. (Refer to “Auction Finalization Management” view in “View Description” file).<br>❖ The system calls `AuctionFinalizationController.listPending()` to retrieve data.<br>❖ It renders a datagrid of auctions where the [status] is either 'awaiting_result' or 'ended'.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **(6)**  | **BR-02** | **Choosing Rules:**<br>❖ The Admin selects a finalization function. The system uses `Frontend_Navigation()` to handle the action.<br>❖ If “Evaluate” is selected, the system redirects to `3.6.1`.<br>❖ If “Finalize” is selected, it redirects to `3.6.2`.<br>❖ If “Override” is selected, it redirects to `3.6.3`.<br>❖ If “Results” is selected, it redirects to `3.6.4`.<br>❖ If “Audit” is selected, it redirects to `3.6.5`.<br>❖ The Admin can only choose one feature at a time.                                                                                                                                                                                                                                                                                                                                                                                |

---

## 5. Related Child Use Cases

| Use Case ID | Use Case Name                   | Description                               |
| :---------- | :------------------------------ | :---------------------------------------- |
| 3.6.1       | Evaluate Auction                | Evaluate auction results after it ends    |
| 3.6.2       | Finalize Auction                | Complete the auction finalization process |
| 3.6.3       | Override Auction Status         | Manually override auction status          |
| 3.6.4       | Get Auction Results             | Retrieve final auction results            |
| 3.6.5       | Get Audit Logs                  | View audit trail for the auction          |
| 3.6.6       | Get Winner Payment Requirements | Retrieve payment requirements for winner  |
| 3.6.7       | Initiate Winner Payment         | Winner initiates final payment            |
| 3.6.8       | Verify Winner Payment           | Verify winner's payment transaction       |