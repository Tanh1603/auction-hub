# 3.9.6 Get Cache Statistics

## 1. Use Case Description

| Field              | Description                                                                                                     |
| ------------------ | --------------------------------------------------------------------------------------------------------------- |
| **Name**           | Get Cache Statistics                                                                                            |
| **Description**    | This use case allows the Admin to view cache statistics for monitoring system performance.                      |
| **Actor**          | Admin, Super Admin                                                                                              |
| **Trigger**        | When the Admin requests `GET /system-variables/cache/stats`.                                                    |
| **Pre-condition**  | • Admin's device must be connected to the internet.<br>• Admin is signed in with `admin` or `super_admin` role. |
| **Post-condition** | The cache statistics are retrieved and displayed to the Admin.                                                  |

## 2. Sequence Flow (MVC)

```plantuml
@startuml
autonumber
skinparam sequenceMessageAlign center

actor "Admin" as User
boundary "SystemConfigPage" as View
control "SystemVariablesController" as Controller
control "SystemVariablesService" as Service

User -> View: Request Cache Statistics
View -> Controller: GET /system-variables/cache/stats
activate Controller

Controller -> Service: getCacheStats()
activate Service

Service -> Service: Calculate Cache Metrics
note right: BR-02

Service --> Controller: CacheStatsDto
Controller --> View: 200 OK (Stats)
View --> User: Display Cache Statistics

deactivate Service
deactivate Controller
@enduml
```

## 3. Activities Flow (Swimlanes)

```plantuml
@startuml
|Admin|
start
:(1) Navigate to Cache Statistics;

|SystemVariablesController|
:(2) Authenticate & Authorize;
note right: BR-01

|SystemVariablesService|
:(3) Calculate Cache Size;
:(4) Calculate Hit/Miss Ratio;
:(5) Get Last Clear Timestamp;

:(6) Return Statistics;

|Admin|
:(7) View Cache Performance Metrics;
stop
@enduml
```

## 4. Business Rules

| Activity    | BR Code   | Description                                                                                                                                                                                           |
| :---------- | :-------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **(1)**     | **BR-01** | **Displaying Rule:**<br><br>Function: `Display_View('SystemConfigPage')`<br><br>Logic:<br>Render Cache Statistics panel.<br>Show loading indicator initially.                                          |
| **(2)**     | **BR-02** | **Authorization Rule (Back-end):**<br><br>Function: Call `SystemVariablesService.getCacheStats()`<br><br>Logic:<br>Check Requestor Role.<br>IF Role NOT IN ['admin', 'super_admin'] THEN Return 403 (Forbidden). |
| **(3)-(5)** | **BR-03** | **Calculation Rule (Back-end):**<br><br>Function: `CacheService.getStats()`<br><br>Logic:<br>Retrieve: `totalEntries`, `hits`, `misses`, `lastClearTimestamp`.<br>Calculate `hitRate` = (hits / (hits + misses)) * 100. |
| **(7)**     | **BR-04** | **Displaying Rule (Data):**<br><br>Function: `Display_CacheStats(stats)`<br><br>Logic:<br>Render: Total Entries, Cache Hits, Cache Misses, Hit Rate (%), Last Cleared At.                             |
