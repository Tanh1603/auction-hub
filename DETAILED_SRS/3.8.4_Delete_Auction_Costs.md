# 3.8.4 Delete Auction Costs

## 1. Use Case Description

| Field              | Description                                                                                                        |
| ------------------ | ------------------------------------------------------------------------------------------------------------------ |
| **Name**           | Delete Auction Costs                                                                                               |
| **Description**    | This use case allows the Admin to delete a Auction Costs information in the system.                                |
| **Actor**          | Admin                                                                                                              |
| **Trigger**        | When the Admin clicks on the [Icon Delete] button on the right of each item on the AuctionCostPage datagrid.       |
| **Pre-condition**  | • Admin's device must be connected to the internet.<br>• Admin is signed in with their account.                    |
| **Post-condition** | The Auction Costs information will be removed from the system and display data change on AuctionCostPage datagrid. |

<h2>2. Sequence Flow (MVC)</h2>

```plantuml
@startuml
autonumber
skinparam sequenceMessageAlign center

actor "Admin" as User
boundary "AuctionCostPage" as View
control "AuctionCostController" as Controller
control "AuctionCostService" as Service
database "AuctionCostRepository" as CostRepo

User -> View: Delete Costs
View -> Controller: DELETE /auction-costs/auction/:auctionId
activate Controller

Controller -> Service: deleteCosts(auctionId, userId)
activate Service

Service -> CostRepo: findByAuctionId(auctionId)
activate CostRepo
CostRepo --> Service: CostsEntity
deactivate CostRepo

alt Costs Not Found
    Service --> Controller: Throw NotFoundException
    Controller --> View: 404 Not Found
    View --> User: Display Error Message
else Costs Found
    Service -> CostRepo: delete(id)
    activate CostRepo
    CostRepo --> Service: Success
    deactivate CostRepo

    Service --> Controller: SuccessResponse
    Controller --> View: 200 OK (Deleted)
    View --> User: View Confirmation
end

deactivate Service
deactivate Controller
@endumal
```

<h2>3. Activities Flow (Swimlanes)</h2>

```plantuml
@startuml
' Use diamond style for cleaner conditionals
skinparam conditionStyle diamond

|Admin|
start
:"(1) Request Cost Deletion";

|AuctionCostService|
:"(2) Authenticate & Authorize";
note right: BR-01

|AuctionCostRepository|
:"(3) Check Existence of Costs";

|AuctionCostService|
' FIX: Quoted the condition string to prevent parsing errors
if ("Costs Found?") then (No)
    :"(4.1) Return 404 Not Found";
    |Admin|
    :"(4.2) View Error Message";
    stop
endif

|AuctionCostRepository|
:"(5) Delete AuctionCost Record";

|AuctionCostService|
:"(6) Return Success";

|Admin|
:"(7) View Confirmation";
stop
@enduml
```

## 4. Business Rules

| Activity | BR Code   | Description                                                                                                                                                                                                                                                                                                                                                                              |
| :------- | :-------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **(1)**  | **BR-01** | **Displaying Rule:**<br>The system displays a 'Confirmation message box' screen. (Refer to View Description) with **MSG 11** (Are you sure you want to delete all auction costs?).<br>Shows auction name and cost summary before deletion.                                                                                                                                               |
| **(1)**  | **BR-02** | **Selecting Rule:**<br>User selects button. If 'Cancel', use `Close()` to end.<br>If 'Confirm Delete', call method `deleteCosts(auctionId)`.                                                                                                                                                                                                                                             |
| **(5)**  | **BR-03** | **Validation Rule (Back-end/Save):**<br>Check selection against table `AUCTION_COST` for constraints.<br>If auction is 'finalized' or 'completed' → display **MSG 9** (Cannot delete historical records).<br>If costs not found → display **MSG 11** (Not Found), return 404.<br>Else, delete data in table `AUCTION_COST`, display **MSG 7** (Success), use `Close()`, update datagrid. |
